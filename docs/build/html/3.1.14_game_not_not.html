

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>3.1.14 GAME– Not Not &mdash; SunFounder Da Vinci Kit  documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="https://ezblock.cc/readDocFile/topHead.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="https://ezblock.cc/readDocFile/topHead.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="4 IOT" href="iot/4_iot_projects.html" />
    <link rel="prev" title="3.1.13 GAME– 10 Second" href="3.1.13_game_10_second.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> SunFounder Da Vinci Kit
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="component_list.html">Component List</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="preparation.html">Preparation</a></li>
<li class="toctree-l1"><a class="reference internal" href="libraries.html">Libraries</a></li>
<li class="toctree-l1"><a class="reference internal" href="gpio_extension_board.html">GPIO Extension Board</a></li>
<li class="toctree-l1"><a class="reference internal" href="download_the_code.html">Download the Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="1_output.html">1 Output</a></li>
<li class="toctree-l1"><a class="reference internal" href="2_input.html">2 Input</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="3_extension.html">3 Extension</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="3.1.1_counting_device.html">3.1.1 Counting Device</a></li>
<li class="toctree-l2"><a class="reference internal" href="3.1.2_welcome.html">3.1.2 Welcome</a></li>
<li class="toctree-l2"><a class="reference internal" href="3.1.3_reversing_alarm.html">3.1.3 Reversing Alarm</a></li>
<li class="toctree-l2"><a class="reference internal" href="3.1.4_smart_fan.html">3.1.4 Smart Fan</a></li>
<li class="toctree-l2"><a class="reference internal" href="3.1.5_battery_indicator.html">3.1.5 Battery Indicator</a></li>
<li class="toctree-l2"><a class="reference internal" href="3.1.6_motion_control.html">3.1.6 Motion Control</a></li>
<li class="toctree-l2"><a class="reference internal" href="3.1.7_traffic_light.html">3.1.7 Traffic Light</a></li>
<li class="toctree-l2"><a class="reference internal" href="3.1.8_overheat_monitor.html">3.1.8 Overheat Monitor</a></li>
<li class="toctree-l2"><a class="reference internal" href="3.1.9_password_lock.html">3.1.9 Password Lock</a></li>
<li class="toctree-l2"><a class="reference internal" href="3.1.10_alarm_bell.html">3.1.10 Alarm Bell</a></li>
<li class="toctree-l2"><a class="reference internal" href="3.1.11_morse_code_generator.html">3.1.11 Morse Code Generator</a></li>
<li class="toctree-l2"><a class="reference internal" href="3.1.12_game_guess_number.html">3.1.12 GAME– Guess Number</a></li>
<li class="toctree-l2"><a class="reference internal" href="3.1.13_game_10_second.html">3.1.13 GAME– 10 Second</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">3.1.14 GAME– Not Not</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#introduction"><strong>Introduction</strong></a></li>
<li class="toctree-l3"><a class="reference internal" href="#components"><strong>Components</strong></a></li>
<li class="toctree-l3"><a class="reference internal" href="#schematic-diagram"><strong>Schematic Diagram</strong></a></li>
<li class="toctree-l3"><a class="reference internal" href="#experimental-procedures"><strong>Experimental Procedures</strong></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#for-c-language-users"><strong>For C Language Users</strong></a></li>
<li class="toctree-l4"><a class="reference internal" href="#for-python-language-users"><strong>For Python Language Users</strong></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#phenomenon-picture"><strong>Phenomenon Picture</strong></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="iot/4_iot_projects.html">4 IOT</a></li>
<li class="toctree-l1"><a class="reference internal" href="processing/play_with_processing.html">Play with Processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="scratch/play_with_scratch.html">Play with Scratch</a></li>
<li class="toctree-l1"><a class="reference internal" href="appendix.html">Appendix</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">SunFounder Da Vinci Kit</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="3_extension.html">3 Extension</a> &raquo;</li>
        
      <li>3.1.14 GAME– Not Not</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/3.1.14_game_not_not.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="game-not-not">
<h1>3.1.14 GAME– Not Not<a class="headerlink" href="#game-not-not" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2><strong>Introduction</strong><a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>In this lesson, we will make an interesting game device, and we call it “Not Not”.</p>
<p>During the game, the dot matrix will refresh an arrow randomly. What you need to do is to press the button in the opposite direction of the arrow within a limited time. If the time is up, or if the button in the same direction as the arrow is pressed, you are out.</p>
<p>This game can really practice your reverse thinking, and now shall we have a try?</p>
</div>
<div class="section" id="components">
<h2><strong>Components</strong><a class="headerlink" href="#components" title="Permalink to this headline">¶</a></h2>
<img alt="_images/list_GAME_Not_Not.png" class="align-center" src="_images/list_GAME_Not_Not.png" />
</div>
<div class="section" id="schematic-diagram">
<h2><strong>Schematic Diagram</strong><a class="headerlink" href="#schematic-diagram" title="Permalink to this headline">¶</a></h2>
<table class="docutils align-default">
<colgroup>
<col style="width: 39%" />
<col style="width: 26%" />
<col style="width: 26%" />
<col style="width: 10%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>T-Board Name</p></td>
<td><p>physical</p></td>
<td><p>wiringPi</p></td>
<td><p>BCM</p></td>
</tr>
<tr class="row-even"><td><p>GPIO17</p></td>
<td><p>Pin 11</p></td>
<td><p>0</p></td>
<td><p>17</p></td>
</tr>
<tr class="row-odd"><td><p>GPIO18</p></td>
<td><p>Pin 12</p></td>
<td><p>1</p></td>
<td><p>18</p></td>
</tr>
<tr class="row-even"><td><p>GPIO27</p></td>
<td><p>Pin 13</p></td>
<td><p>2</p></td>
<td><p>27</p></td>
</tr>
<tr class="row-odd"><td><p>GPIO20</p></td>
<td><p>Pin 38</p></td>
<td><p>28</p></td>
<td><p>20</p></td>
</tr>
<tr class="row-even"><td><p>GPIO26</p></td>
<td><p>Pin 37</p></td>
<td><p>25</p></td>
<td><p>26</p></td>
</tr>
</tbody>
</table>
<img alt="_images/Schematic_three_one14.png" class="align-center" src="_images/Schematic_three_one14.png" />
</div>
<div class="section" id="experimental-procedures">
<h2><strong>Experimental Procedures</strong><a class="headerlink" href="#experimental-procedures" title="Permalink to this headline">¶</a></h2>
<p><strong>Step 1:</strong> Build the circuit.</p>
<img alt="_images/image280.png" src="_images/image280.png" />
<div class="section" id="for-c-language-users">
<h3><strong>For C Language Users</strong><a class="headerlink" href="#for-c-language-users" title="Permalink to this headline">¶</a></h3>
<p><strong>Step 5:</strong> Go to the folder of code.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">pi</span><span class="o">/</span><span class="n">davinci</span><span class="o">-</span><span class="n">kit</span><span class="o">-</span><span class="k">for</span><span class="o">-</span><span class="n">raspberry</span><span class="o">-</span><span class="n">pi</span><span class="o">/</span><span class="n">c</span><span class="o">/</span><span class="mf">3.1.14</span><span class="o">/</span>
</pre></div>
</div>
<p><strong>Step 6</strong>: Compile.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gcc</span> <span class="mf">3.1.14</span><span class="n">_GAME_NotNot</span><span class="o">.</span><span class="n">c</span> <span class="o">-</span><span class="n">lwiringPi</span>
</pre></div>
</div>
<p><strong>Step 7</strong>: Run.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="o">./</span><span class="n">a</span><span class="o">.</span><span class="n">out</span>
</pre></div>
</div>
<p>After the program starts, a left or right arrow will be refreshed at
random on the dot matrix. What you need to do is to press the button in
the opposite direction of the arrow within a limited time. Then
“<strong>√</strong>” appears on the dot matrix. If the time is up, or if the
button in the same direction as the arrow is pressed, you are out and
the dot matrix displays “x”. You can also add 2 new buttons or replace
them with Joystick keys for up, down, left and right— 4 directions to
increase the difficulty of the game.</p>
<p><strong>Code Explanation</strong></p>
<p>Based on <strong>1.1.6 LED Dot Matrix</strong>, this lesson adds <strong>2</strong> buttons to
make an amusing game device. So, if you are not very familiar with the
dot matrix, please refer to <strong>1.1.6 LED Dot Matrix</strong>.</p>
<p>The whole program process is as below:</p>
<ol class="arabic simple">
<li><p>Randomly select an arrow direction and generate <strong>timer 1</strong>.</p></li>
<li><p>Display the arrow image on the dot matrix.</p></li>
<li><p>Judge the button input. If the button is pressed or <strong>timer 1</strong>
reminds time’s up, judgement starts.</p></li>
<li><p>Display the image on the basis of a judging result; meanwhile,
generate <strong>timer 2</strong>.</p></li>
<li><p>Rerun <strong>step 1</strong> when <strong>timer 2</strong> reminds time’s up.</p></li>
</ol>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">struct</span> <span class="nc">GLYPH</span><span class="p">{</span>
    <span class="kt">char</span> <span class="o">*</span><span class="n">word</span><span class="p">;</span>
    <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">code</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="nc">GLYPH</span> <span class="n">arrow</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">=</span>
<span class="p">{</span>
    <span class="p">{</span><span class="s">&quot;right&quot;</span><span class="p">,{</span><span class="mh">0xFF</span><span class="p">,</span><span class="mh">0xEF</span><span class="p">,</span><span class="mh">0xDF</span><span class="p">,</span><span class="mh">0x81</span><span class="p">,</span><span class="mh">0xDF</span><span class="p">,</span><span class="mh">0xEF</span><span class="p">,</span><span class="mh">0xFF</span><span class="p">,</span><span class="mh">0xFF</span><span class="p">}},</span>
    <span class="c1">// {&quot;down&quot;,{0xFF,0xEF,0xC7,0xAB,0xEF,0xEF,0xEF,0xFF}},</span>
    <span class="c1">// {&quot;up&quot;,{0xFF,0xEF,0xEF,0xEF,0xAB,0xC7,0xEF,0xFF}},</span>
    <span class="p">{</span><span class="s">&quot;left&quot;</span><span class="p">,{</span><span class="mh">0xFF</span><span class="p">,</span><span class="mh">0xF7</span><span class="p">,</span><span class="mh">0xFB</span><span class="p">,</span><span class="mh">0x81</span><span class="p">,</span><span class="mh">0xFB</span><span class="p">,</span><span class="mh">0xF7</span><span class="p">,</span><span class="mh">0xFF</span><span class="p">,</span><span class="mh">0xFF</span><span class="p">}}</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="nc">GLYPH</span> <span class="n">check</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">=</span>
<span class="p">{</span>
    <span class="p">{</span><span class="s">&quot;wrong&quot;</span><span class="p">,{</span><span class="mh">0xFF</span><span class="p">,</span><span class="mh">0xBB</span><span class="p">,</span><span class="mh">0xD7</span><span class="p">,</span><span class="mh">0xEF</span><span class="p">,</span><span class="mh">0xD7</span><span class="p">,</span><span class="mh">0xBB</span><span class="p">,</span><span class="mh">0xFF</span><span class="p">,</span><span class="mh">0xFF</span><span class="p">}},</span>
    <span class="p">{</span><span class="s">&quot;right&quot;</span><span class="p">,{</span><span class="mh">0xFF</span><span class="p">,</span><span class="mh">0xFF</span><span class="p">,</span><span class="mh">0xF7</span><span class="p">,</span><span class="mh">0xEB</span><span class="p">,</span><span class="mh">0xDF</span><span class="p">,</span><span class="mh">0xBF</span><span class="p">,</span><span class="mh">0xFF</span><span class="p">,</span><span class="mh">0xFF</span><span class="p">}}</span>
<span class="p">};</span>
</pre></div>
</div>
<p>GLYPH structure works like a dictionary: the <strong>word</strong> attribute
corresponds to the <strong>key</strong> on the dictionary; the <strong>code</strong> attribute
corresponds to the <strong>value</strong>.</p>
<p>Here, code is used to store an array for dot matrix to display images
(an 8x8 bit array).</p>
<p>Here, the array <strong>arrow</strong> can be used to display the arrow pattern in
up, down, left and right directions on the LED dot matrix.</p>
<p>Now <strong>down</strong> and <strong>up</strong> are commented and uncomment them if needed.</p>
<p>The array <strong>check</strong> is used to display these two images: ”<strong>×</strong>” and
”<strong>√</strong>”.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">char</span> <span class="o">*</span><span class="nf">lookup</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">key</span><span class="p">,</span><span class="k">struct</span> <span class="nc">GLYPH</span> <span class="o">*</span><span class="n">glyph</span><span class="p">,</span><span class="kt">int</span> <span class="n">length</span><span class="p">){</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">length</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="n">strcmp</span><span class="p">(</span><span class="n">glyph</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">word</span><span class="p">,</span><span class="n">key</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">){</span>
            <span class="k">return</span> <span class="n">glyph</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">code</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The function <strong>lookup()</strong> works by “checking the dictionary”. Define a
<strong>key,</strong> search the same words as <strong>key</strong> in the structure <strong>GLYPH
*glyph</strong> and return the corresponding information— “<strong>code</strong>” of
the certain word.</p>
<p>The function <strong>Strcmp()</strong> is used to compare the identity of two
character strings <strong>glyph[i].word</strong> and <strong>key</strong>; if the identity is
judged, return <strong>glyph[i].code</strong> ( as shown).</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">display</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">glyphCode</span><span class="p">){</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">8</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">hc595_in</span><span class="p">(</span><span class="n">glyphCode</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
        <span class="n">hc595_in</span><span class="p">(</span><span class="mh">0x80</span><span class="o">&gt;&gt;</span><span class="n">i</span><span class="p">);</span>
        <span class="n">hc595_out</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Display the specified pattern on the dot matrix.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">createGlyph</span><span class="p">(){</span>
    <span class="n">srand</span><span class="p">(</span><span class="n">time</span><span class="p">(</span><span class="nb">NULL</span><span class="p">));</span>
    <span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="n">rand</span><span class="p">()</span><span class="o">%</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="n">arrow</span><span class="p">)</span><span class="o">/</span><span class="k">sizeof</span><span class="p">(</span><span class="n">arrow</span><span class="p">[</span><span class="mi">0</span><span class="p">]));</span>
    <span class="n">waypoint</span><span class="o">=</span><span class="n">arrow</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">word</span><span class="p">;</span>
    <span class="n">stage</span><span class="o">=</span><span class="s">&quot;PLAY&quot;</span><span class="p">;</span>
    <span class="n">alarm</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The function <strong>createGlyph()</strong> is used to randomly select a direction
(the word attribute of an element in the array <strong>arrow[]:</strong>
“<strong>left</strong>”, “<strong>right</strong>”… ). Set the stage as “PLAY” and start
a 2-second alarm clock function.</p>
<p><strong>srand(time(NULL)):</strong> Initializes random seeds that are from the system
clock.</p>
<p><strong>(sizeof(arrow)/sizeof(arrow[0]))：</strong>Get the length of the array, the
outcome is 2.</p>
<p><strong>rand()%2:</strong> The remainder is <strong>0</strong> or <strong>1,</strong> gotten from dividing a
generated random number by 2<strong>.</strong></p>
<p><strong>waypoint=arrow[i].word:</strong> The outcome should be “right” or “left”.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">checkPoint</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">inputKey</span><span class="p">){</span>
    <span class="n">alarm</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="n">inputKey</span><span class="o">==</span><span class="n">waypoint</span><span class="o">||</span><span class="n">inputKey</span><span class="o">==</span><span class="s">&quot;empty&quot;</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">waypoint</span><span class="o">=</span><span class="s">&quot;wrong&quot;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">else</span><span class="p">{</span>
        <span class="n">waypoint</span><span class="o">=</span><span class="s">&quot;right&quot;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">stage</span><span class="o">=</span><span class="s">&quot;CHECK&quot;</span><span class="p">;</span>
    <span class="n">alarm</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>checkPoint() is used to check the button input; if the button is not
pressed or the button in the same direction as the arrow is pressed, the
outcome of the waypoint is wrong and “<strong>x</strong>” appears on the dot
matrix. Otherwise, the waypoint is right and dot matrix displays
“<strong>√</strong>”. Here the <strong>stage</strong> is <strong>CHECK,</strong> and there can be set a
1-second alarm clock function.</p>
<p>alarm() is also called “alarm clock”, in which a timer can be set, and
it sends <strong>SIGALRM</strong> signals to the progress when the defined time is
up.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">getKey</span><span class="p">(){</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">digitalRead</span><span class="p">(</span><span class="n">AButtonPin</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span><span class="o">&amp;&amp;</span><span class="n">digitalRead</span><span class="p">(</span><span class="n">BButtonPin</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span>
    <span class="p">{</span><span class="n">checkPoint</span><span class="p">(</span><span class="s">&quot;right&quot;</span><span class="p">);}</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">digitalRead</span><span class="p">(</span><span class="n">AButtonPin</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="o">&amp;&amp;</span><span class="n">digitalRead</span><span class="p">(</span><span class="n">BButtonPin</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span>
    <span class="p">{</span><span class="n">checkPoint</span><span class="p">(</span><span class="s">&quot;left&quot;</span><span class="p">);}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>getKey() reads the states of the these two buttons; if the right button
is pressed, the parameter of the function checkPoint() is <strong>right</strong> and
if the left button is pressed, the parameter is <strong>left</strong>.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">timer</span><span class="p">(){</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">stage</span><span class="o">==</span><span class="s">&quot;PLAY&quot;</span><span class="p">){</span>
        <span class="n">checkPoint</span><span class="p">(</span><span class="s">&quot;empty&quot;</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">stage</span><span class="o">==</span><span class="s">&quot;CHECK&quot;</span><span class="p">){</span>
        <span class="n">createGlyph</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Previously, timer() was called when set as the alarm() time’s up. Then
under the “PLAY” mode, checkPoint() is to be called to judge the
outcome. If the program is set to “CHECK” mode, the function
createGlyph() should be called to select new patterns.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">main</span><span class="p">(){</span>
    <span class="n">setup</span><span class="p">();</span>
    <span class="n">signal</span><span class="p">(</span><span class="n">SIGALRM</span><span class="p">,</span><span class="n">timer</span><span class="p">);</span>
    <span class="n">createGlyph</span><span class="p">();</span>
    <span class="kt">char</span> <span class="o">*</span><span class="n">code</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
    <span class="k">while</span><span class="p">(</span><span class="mi">1</span><span class="p">){</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">stage</span> <span class="o">==</span> <span class="s">&quot;PLAY&quot;</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">code</span><span class="o">=</span><span class="n">lookup</span><span class="p">(</span><span class="n">waypoint</span><span class="p">,</span><span class="n">arrow</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="n">arrow</span><span class="p">)</span><span class="o">/</span><span class="k">sizeof</span><span class="p">(</span><span class="n">arrow</span><span class="p">[</span><span class="mi">0</span><span class="p">]));</span>
            <span class="n">display</span><span class="p">(</span><span class="n">code</span><span class="p">);</span>
            <span class="n">getKey</span><span class="p">();</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">stage</span> <span class="o">==</span> <span class="s">&quot;CHECK&quot;</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">code</span> <span class="o">=</span> <span class="n">lookup</span><span class="p">(</span><span class="n">waypoint</span><span class="p">,</span><span class="n">check</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="n">check</span><span class="p">)</span><span class="o">/</span><span class="k">sizeof</span><span class="p">(</span><span class="n">check</span><span class="p">[</span><span class="mi">0</span><span class="p">]));</span>
            <span class="n">display</span><span class="p">(</span><span class="n">code</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The working of the function signal(SIGALRM,timer): calling the timer()
function when a SIGALRM signal (generated by the alarm clock function
alarm()) is received.</p>
<p>When the program starts, call createGlyph() one time at first and then
start the loop.</p>
<p>In the loop: under PLAY mode, the dot matrix displays arrow patterns and
check the button state; if under CHECK mode, what is displayed is
“<strong>x</strong>” or “<strong>√</strong>”.</p>
</div>
<div class="section" id="for-python-language-users">
<h3><strong>For Python Language Users</strong><a class="headerlink" href="#for-python-language-users" title="Permalink to this headline">¶</a></h3>
<p><strong>Step 5</strong>: Get into the folder of code.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">pi</span><span class="o">/</span><span class="n">davinci</span><span class="o">-</span><span class="n">kit</span><span class="o">-</span><span class="k">for</span><span class="o">-</span><span class="n">raspberry</span><span class="o">-</span><span class="n">pi</span><span class="o">/</span><span class="n">python</span>
</pre></div>
</div>
<p><strong>Step 6</strong>: Run.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">python3</span> <span class="mf">3.1.14</span><span class="n">_GAME_NotNot</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>After starting the program, on the dot matrix appears an arrow pointing
to the right or the left. What you need to do is to press the button in
the opposite direction of the arrow within a limited time. Then
“<strong>√</strong>” appears on the dot matrix. If the time is up, or if the
button in the same direction as the arrow is pressed, you are out and
the dot matrix displays “x”. You can also add 2 new buttons or replace
them with Joystick keys for up, down, left and right— 4 directions to
increase the difficulty of the game.</p>
<p><strong>Code Explanation</strong></p>
<p>Based on <strong>1.1.6 LED Dot Matrix</strong>, this lesson adds <strong>2</strong> buttons to
make an amusing game device. So, if you are not very familiar with the
dot matrix, please refer to <strong>1.1.6 LED Dot Matrix</strong>.</p>
<p>The whole program process is as below:</p>
<img alt="_images/notnot3.png" src="_images/notnot3.png" />
<ol class="arabic simple">
<li><p>Randomly select an arrow direction and generate <strong>timer 1</strong>.</p></li>
<li><p>Display the corresponding arrow image on the dot matrix.</p></li>
<li><p>Judge the button input. If the button is pressed or <strong>timer 1</strong>
reminds time’s up, judgement starts.</p></li>
<li><p>Display the image on the basis of a judging result; meanwhile,
generate <strong>timer 2</strong>.</p></li>
<li><p>Rerun <strong>step 1</strong> when <strong>timer 2</strong> reminds time’s up.</p></li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">creatGlyph</span><span class="p">()</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">stage</span> <span class="o">==</span> <span class="s2">&quot;PLAY&quot;</span><span class="p">:</span>
            <span class="n">display</span><span class="p">(</span><span class="n">arrow</span><span class="p">[</span><span class="n">waypoint</span><span class="p">])</span>
            <span class="n">getKey</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">stage</span> <span class="o">==</span> <span class="s2">&quot;CHECK&quot;</span><span class="p">:</span>
            <span class="n">display</span><span class="p">(</span><span class="n">check</span><span class="p">[</span><span class="n">waypoint</span><span class="p">])</span>
</pre></div>
</div>
<p>Main() contains the whole running process.</p>
<p>When the program starts, call createGlyph() one time at first and then
start the loop.</p>
<p>In the loop: under PLAY mode, the dot matrix displays arrow patterns and
check the button state; if under CHECK mode, what is displayed is
“<strong>x</strong>” or “<strong>√</strong>”.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">arrow</span><span class="o">=</span><span class="p">{</span>
    <span class="c1">#&quot;down&quot; :[0xFF,0xEF,0xC7,0xAB,0xEF,0xEF,0xEF,0xFF],</span>
    <span class="c1">#&quot;up&quot;:[0xFF,0xEF,0xEF,0xEF,0xAB,0xC7,0xEF,0xFF],</span>
    <span class="s2">&quot;right&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="mh">0xFF</span><span class="p">,</span><span class="mh">0xEF</span><span class="p">,</span><span class="mh">0xDF</span><span class="p">,</span><span class="mh">0x81</span><span class="p">,</span><span class="mh">0xDF</span><span class="p">,</span><span class="mh">0xEF</span><span class="p">,</span><span class="mh">0xFF</span><span class="p">,</span><span class="mh">0xFF</span><span class="p">],</span>
    <span class="s2">&quot;left&quot;</span><span class="p">:[</span><span class="mh">0xFF</span><span class="p">,</span><span class="mh">0xF7</span><span class="p">,</span><span class="mh">0xFB</span><span class="p">,</span><span class="mh">0x81</span><span class="p">,</span><span class="mh">0xFB</span><span class="p">,</span><span class="mh">0xF7</span><span class="p">,</span><span class="mh">0xFF</span><span class="p">,</span><span class="mh">0xFF</span><span class="p">]</span>
<span class="p">}</span>
<span class="n">check</span><span class="o">=</span><span class="p">{</span>
    <span class="s2">&quot;wrong&quot;</span><span class="p">:[</span><span class="mh">0xFF</span><span class="p">,</span><span class="mh">0xBB</span><span class="p">,</span><span class="mh">0xD7</span><span class="p">,</span><span class="mh">0xEF</span><span class="p">,</span><span class="mh">0xD7</span><span class="p">,</span><span class="mh">0xBB</span><span class="p">,</span><span class="mh">0xFF</span><span class="p">,</span><span class="mh">0xFF</span><span class="p">],</span>
    <span class="s2">&quot;right&quot;</span><span class="p">:[</span><span class="mh">0xFF</span><span class="p">,</span><span class="mh">0xFF</span><span class="p">,</span><span class="mh">0xF7</span><span class="p">,</span><span class="mh">0xEB</span><span class="p">,</span><span class="mh">0xDF</span><span class="p">,</span><span class="mh">0xBF</span><span class="p">,</span><span class="mh">0xFF</span><span class="p">,</span><span class="mh">0xFF</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Here, the <strong>dictionary</strong> arrow can be used to display the arrow pattern
in up, down, left and right directions on the LED dot matrix.</p>
<p>Now down and up are commented and uncomment them if needed.</p>
<p>The <strong>dictionary</strong> check is used to display these two images:
”<strong>×</strong>” and ”<strong>√</strong>”.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">display</span><span class="p">(</span><span class="n">glyphCode</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">):</span>
        <span class="n">hc595_shift</span><span class="p">(</span><span class="n">glyphCode</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">hc595_shift</span><span class="p">(</span><span class="mh">0x80</span><span class="o">&gt;&gt;</span><span class="n">i</span><span class="p">)</span>
        <span class="n">GPIO</span><span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="n">RCLK</span><span class="p">,</span> <span class="n">GPIO</span><span class="o">.</span><span class="n">HIGH</span><span class="p">)</span>
        <span class="n">GPIO</span><span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="n">RCLK</span><span class="p">,</span> <span class="n">GPIO</span><span class="o">.</span><span class="n">LOW</span><span class="p">)</span>
</pre></div>
</div>
<p>Display the specified pattern on the dot matrix.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">creatGlyph</span><span class="p">():</span>
    <span class="k">global</span> <span class="n">waypoint</span>
    <span class="k">global</span> <span class="n">stage</span>
    <span class="k">global</span> <span class="n">timerPlay</span>
    <span class="n">waypoint</span><span class="o">=</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">arrow</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
    <span class="n">stage</span> <span class="o">=</span> <span class="s2">&quot;PLAY&quot;</span>
    <span class="n">timerPlay</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Timer</span><span class="p">(</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">timeOut</span><span class="p">)</span>
    <span class="n">timerPlay</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</pre></div>
</div>
<p>The function <strong>createGlyph()</strong> is used to randomly select a direction
(the word attribute of an element in the array <strong>arrow[]:</strong>
“<strong>left</strong>”, “<strong>right</strong>”… ). Set the stage as “PLAY” and start
a 2-second alarm clock function.</p>
<p><strong>arrow.keys():</strong> Select the keys “right”and “left” in the arrow array.</p>
<p>l<strong>ist(arrow.keys()):</strong> Combine these keys into an array.</p>
<p><strong>random.choice(list(arrow.keys())):</strong> Randomly select an element in the
array.</p>
<p>So, The outcome of <strong>waypoint=random.choice(list(arrow.keys()))</strong> should
be “right” or “left”.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">checkPoint</span><span class="p">(</span><span class="n">inputKey</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">waypoint</span>
    <span class="k">global</span> <span class="n">stage</span>
    <span class="k">global</span> <span class="n">timerCheck</span>
    <span class="k">if</span> <span class="n">inputKey</span> <span class="o">==</span> <span class="s2">&quot;empty&quot;</span> <span class="ow">or</span> <span class="n">inputKey</span> <span class="o">==</span> <span class="n">waypoint</span><span class="p">:</span>
        <span class="n">waypoint</span> <span class="o">=</span> <span class="s2">&quot;wrong&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">waypoint</span> <span class="o">=</span> <span class="s2">&quot;right&quot;</span>
    <span class="n">timerPlay</span><span class="o">.</span><span class="n">cancel</span><span class="p">()</span>
    <span class="n">stage</span> <span class="o">=</span> <span class="s2">&quot;CHECK&quot;</span>
    <span class="n">timerCheck</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Timer</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">creatGlyph</span><span class="p">)</span>
    <span class="n">timerCheck</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</pre></div>
</div>
<p>checkPoint() is to detect the current state of button input:</p>
<p>If no button is pressed or the button in the same direction as the the
arrow is pressed, the assigned value of the <strong>``waypoint``</strong> is <strong>``wrong``</strong>
and there displays <code class="docutils literal notranslate"><span class="pre">x</span></code> on the dot matrix.</p>
<p>Otherwise, the waypoint is right and “<strong>√</strong>” appears.</p>
<p>Now the stage is <strong>CHECK</strong> and start a 1-second timer <strong>timerCheck</strong> to
call the function creatGlyph() in a second.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">timeOut</span><span class="p">():</span>
    <span class="n">checkPoint</span><span class="p">(</span><span class="s2">&quot;empty&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>In the function timeout(), set the parameter of checkPoint() as
”<strong>empty</strong>”.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">getKey</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">GPIO</span><span class="o">.</span><span class="n">input</span><span class="p">(</span><span class="n">AButtonPin</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">GPIO</span><span class="o">.</span><span class="n">input</span><span class="p">(</span><span class="n">BButtonPin</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
        <span class="n">checkPoint</span><span class="p">(</span><span class="s2">&quot;right&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">GPIO</span><span class="o">.</span><span class="n">input</span><span class="p">(</span><span class="n">AButtonPin</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">GPIO</span><span class="o">.</span><span class="n">input</span><span class="p">(</span><span class="n">BButtonPin</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">checkPoint</span><span class="p">(</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>getKey() reads the state of these two buttons, and if the right button
is pressed, the parameter of checkPoint() is <strong>right</strong>; if the left
button is pressed, the parameter is <strong>left</strong>.</p>
</div>
</div>
<div class="section" id="phenomenon-picture">
<h2><strong>Phenomenon Picture</strong><a class="headerlink" href="#phenomenon-picture" title="Permalink to this headline">¶</a></h2>
<img alt="_images/image281.jpeg" class="align-center" src="_images/image281.jpeg" />
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="iot/4_iot_projects.html" class="btn btn-neutral float-right" title="4 IOT" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="3.1.13_game_10_second.html" class="btn btn-neutral float-left" title="3.1.13 GAME– 10 Second" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, sunfounder.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>