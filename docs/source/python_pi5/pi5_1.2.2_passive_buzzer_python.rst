.. note::

    隆Hola! Bienvenido a la Comunidad de Entusiastas de SunFounder para Raspberry Pi, Arduino y ESP32 en Facebook. Sum茅rgete en el mundo de Raspberry Pi, Arduino y ESP32 junto a otros entusiastas.

    **驴Por qu茅 unirse?**

    - **Soporte Experto**: Resuelve problemas postventa y desaf铆os t茅cnicos con la ayuda de nuestra comunidad y equipo.
    - **Aprende y Comparte**: Intercambia consejos y tutoriales para mejorar tus habilidades.
    - **Avances Exclusivos**: Accede anticipadamente a anuncios de nuevos productos y adelantos exclusivos.
    - **Descuentos Especiales**: Aprovecha descuentos exclusivos en nuestros productos m谩s recientes.
    - **Promociones Festivas y Sorteos**: Participa en sorteos y promociones especiales.

     驴Listo para explorar y crear con nosotros? Haz clic en [|link_sf_facebook|] y 煤nete hoy mismo.

.. _1.2.2_py_pi5:

1.2.2 Zumbador Pasivo
========================

Introducci贸n
---------------

En este proyecto, aprenderemos a hacer que un zumbador pasivo reproduzca m煤sica.

Componentes Necesarios
-------------------------

Para este proyecto, necesitamos los siguientes componentes. 

.. image:: ../python_pi5/img/1.2.2_passive_buzzer_list.png

.. raw:: html

   <br/>

Diagrama de Conexiones
------------------------

En este experimento, se utiliza un zumbador pasivo, un transistor PNP y una 
resistencia de 1k entre la base del transistor y el GPIO para proteger el transistor.

Al suministrar diferentes frecuencias al GPIO17, el zumbador pasivo emitir谩 
sonidos de distintas tonalidades; de esta forma, el zumbador puede reproducir m煤sica.

============ ======== ======== ===
T-Board Name physical wiringPi BCM
GPIO17       Pin 11   0        17
============ ======== ======== ===

.. image:: ../python_pi5/img/1.2.2_passive_buzzer_schematic.png


Procedimientos del Experimento
----------------------------------

**Paso 1**: Construye el circuito. (El zumbador pasivo tiene una placa verde en la parte trasera).

.. image:: ../python_pi5/img/1.2.2_PassiveBuzzer_circuit.png

**Paso 2:** Cambia al directorio correspondiente.

.. raw:: html

   <run></run>

.. code-block::

    cd ~/davinci-kit-for-raspberry-pi/python-pi5

**Paso 3:** Ejecuta el c贸digo.

.. raw:: html

   <run></run>

.. code-block::

    sudo python3 1.2.2_PassiveBuzzer.py

Tras ejecutar el c贸digo, el zumbador reproducir谩 una melod铆a.

.. warning::

    Si aparece el mensaje de error ``RuntimeError: Cannot determine SOC peripheral base address``, consulta :ref:`faq_soc` 

**C贸digo**

.. note::

    Puedes **Modificar/Restablecer/Copiar/Ejecutar/Detener** el c贸digo a continuaci贸n. Antes de eso, aseg煤rate de estar en la ruta del c贸digo fuente, como ``davinci-kit-for-raspberry-pi/python-pi5``. Despu茅s de modificar el c贸digo, puedes ejecutarlo directamente para ver el efecto.

.. raw:: html

    <run></run>

.. code-block:: python

   #!/usr/bin/env python3
   from gpiozero import TonalBuzzer
   from time import sleep

   # Inicializa un TonalBuzzer conectado al pin GPIO 17
   tb = TonalBuzzer(17)  # Aseg煤rate de que este pin sea el correcto en tu configuraci贸n

   def play(tune):
       """
       Play a musical tune using the buzzer.
       :param tune: List of tuples (note, duration), where each tuple represents a note and its duration.
       """
       for note, duration in tune:
           print(note)  # Muestra en consola la nota actual
           tb.play(note)  # Reproduce la nota en el zumbador
           sleep(float(duration))  # Pausa durante la duraci贸n de la nota
       tb.stop()  # Detiene el sonido al completar la melod铆a

   # Define una melod铆a como una secuencia de notas y duraciones
   tune = [('C#4', 0.2), ('D4', 0.2), (None, 0.2),
       ('Eb4', 0.2), ('E4', 0.2), (None, 0.6),
       ('F#4', 0.2), ('G4', 0.2), (None, 0.6),
       ('Eb4', 0.2), ('E4', 0.2), (None, 0.2),
       ('F#4', 0.2), ('G4', 0.2), (None, 0.2),
       ('C4', 0.2), ('B4', 0.2), (None, 0.2),
       ('F#4', 0.2), ('G4', 0.2), (None, 0.2),
       ('B4', 0.2), ('Bb4', 0.5), (None, 0.6),
       ('A4', 0.2), ('G4', 0.2), ('E4', 0.2), 
       ('D4', 0.2), ('E4', 0.2)]

   try:
       play(tune)  # Ejecuta la funci贸n play para comenzar la melod铆a

   except KeyboardInterrupt:
       # Maneja la interrupci贸n de teclado para una terminaci贸n limpia
       pass



**Explicaci贸n del C贸digo**

1. Estas l铆neas importan la clase ``TonalBuzzer`` de la librer铆a ``gpiozero`` para controlar el zumbador y la funci贸n ``sleep`` del m贸dulo ``time`` para crear pausas.

   .. code-block:: python  

       #!/usr/bin/env python3
       from gpiozero import TonalBuzzer
       from time import sleep


2. Esta l铆nea inicializa un objeto ``TonalBuzzer`` en el pin GPIO 17.
    
   .. code-block:: python
       
       # Inicializa un TonalBuzzer conectado al pin GPIO 17
       tb = TonalBuzzer(17)  # Aseg煤rate de que este pin sea el correcto en tu configuraci贸n


3. La funci贸n ``play`` recorre una lista de tuplas que representan notas musicales y sus duraciones. Cada nota se reproduce durante el tiempo especificado, y el zumbador se detiene despu茅s de completar la melod铆a.
    
   .. code-block:: python  

       def play(tune):
           """
           Play a musical tune using the buzzer.
           :param tune: List of tuples (note, duration), where each tuple represents a note and its duration.
           """
           for note, duration in tune:
               print(note)  # Muestra en consola la nota actual
               tb.play(note)  # Reproduce la nota en el zumbador
               sleep(float(duration))  # Pausa durante la duraci贸n de la nota
           tb.stop()  # Detiene el sonido al completar la melod铆a


4. La melod铆a se define como una secuencia de notas (frecuencia) y duraciones (segundos).
    
   .. code-block:: python

       # Define una melod铆a como una secuencia de notas y duraciones
       tune = [('C#4', 0.2), ('D4', 0.2), (None, 0.2),
           ('Eb4', 0.2), ('E4', 0.2), (None, 0.6),
           ('F#4', 0.2), ('G4', 0.2), (None, 0.6),
           ('Eb4', 0.2), ('E4', 0.2), (None, 0.2),
           ('F#4', 0.2), ('G4', 0.2), (None, 0.2),
           ('C4', 0.2), ('B4', 0.2), (None, 0.2),
           ('F#4', 0.2), ('G4', 0.2), (None, 0.2),
           ('B4', 0.2), ('Bb4', 0.5), (None, 0.6),
           ('A4', 0.2), ('G4', 0.2), ('E4', 0.2), 
           ('D4', 0.2), ('E4', 0.2)]  


5. La funci贸n ``play(tune)`` se llama dentro de un bloque ``try``. Una ``KeyboardInterrupt`` (Ctrl+C) detendr谩 el programa de manera segura.
    
   .. code-block:: python  
       
       try:
           play(tune)  # Ejecuta la funci贸n play para comenzar la melod铆a

       except KeyboardInterrupt:
           # Maneja la interrupci贸n de teclado para una terminaci贸n limpia
           pass
