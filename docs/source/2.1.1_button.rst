.. note::

    隆Hola! Bienvenido a la comunidad de entusiastas de SunFounder para Raspberry Pi, Arduino y ESP32 en Facebook. nete para profundizar en Raspberry Pi, Arduino y ESP32 junto a otros apasionados.

    **驴Por qu茅 unirse?**

    - **Soporte de expertos**: Resuelve problemas postventa y desaf铆os t茅cnicos con la ayuda de nuestra comunidad y equipo.
    - **Aprender y compartir**: Intercambia consejos y tutoriales para mejorar tus habilidades.
    - **Acceso exclusivo**: Obt茅n primicias sobre nuevos productos y adelantos.
    - **Descuentos especiales**: Disfruta de descuentos exclusivos en nuestros productos m谩s recientes.
    - **Promociones festivas y sorteos**: Participa en sorteos y promociones de temporada.

     驴Listo para explorar y crear con nosotros? Haz clic en [|link_sf_facebook|] y 煤nete hoy mismo.

2.1.1 Bot贸n
==============

Introducci贸n
------------------

En esta lecci贸n, aprenderemos c贸mo encender o apagar un LED usando un
bot贸n.

Componentes
----------------

.. image:: img/list_2.1.1_Button.png

Principio
--------------

**Bot贸n**

El bot贸n es un componente com煤n utilizado para controlar dispositivos electr贸nicos. 
Se usa normalmente como interruptor para conectar o desconectar circuitos. Aunque 
los botones vienen en diversos tama帽os y formas, el que utilizamos aqu铆 es un 
mini-bot贸n de 6 mm, como se muestra en las siguientes im谩genes.

Los dos pines de la izquierda est谩n conectados entre s铆, y el de la derecha es 
similar al de la izquierda, como se muestra a continuaci贸n:

.. image:: img/image148.png
    :width: 400
    :align: center

El s铆mbolo que se muestra a continuaci贸n es el que se usa habitualmente para 
representar un bot贸n en los circuitos.

.. image:: img/image301.png
    :width: 400
    :align: center


Cuando se presiona el bot贸n, los 4 pines se conectan, cerrando el
circuito.

Diagrama Esquem谩tico
-------------------------

Utiliza un bot贸n normalmente abierto como entrada para la Raspberry Pi. 
La conexi贸n se muestra en el diagrama esquem谩tico a continuaci贸n. Cuando 
se presiona el bot贸n, el GPIO18 pasar谩 a nivel bajo (0V). Podemos detectar 
el estado del GPIO18 mediante programaci贸n. Es decir, si el GPIO18 cambia 
a nivel bajo, significa que el bot贸n ha sido presionado. Puedes ejecutar 
el c贸digo correspondiente cuando se presiona el bot贸n y el LED se encender谩.

.. note::
    La pata m谩s larga del LED es el 谩nodo y la m谩s corta es el
    c谩todo.

.. image:: img/image302.png
    :width: 600
    :align: center

.. image:: img/image303.png
    :width: 400
    :align: center


Procedimientos Experimentales
---------------------------------

**Paso 1**: Construye el circuito.

.. image:: img/image152.png
    :width: 800

Para Usuarios de Lenguaje C
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

**Paso 2**: Abre el archivo de c贸digo.

.. raw:: html

   <run></run>

.. code-block::

    cd ~/davinci-kit-for-raspberry-pi/c/2.1.1/

.. note::
    Cambia el directorio a la ruta del c贸digo de este experimento usando **cd**.

**Paso 3**: Compila el c贸digo.

.. raw:: html

   <run></run>

.. code-block::

    gcc 2.1.1_Button.c -lwiringPi

**Paso 4**: Ejecuta el archivo compilado.

.. raw:: html

   <run></run>

.. code-block::

    sudo ./a.out

Despu茅s de ejecutar el c贸digo, al presionar el bot贸n, el LED se encender谩; 
de lo contrario, se apagar谩.

.. note::

    Si no funciona despu茅s de ejecutarlo, o aparece un mensaje de error: \"wiringPi.h: No such file or directory", consulta :ref:`C code is not working?`.

**C贸digo**

.. code-block:: c

    #include <wiringPi.h>
    #include <stdio.h>

    #define LedPin      0
    #define ButtonPin   1

    int main(void){
        // Si la inicializaci贸n de wiring falla, imprime un mensaje en pantalla
        if(wiringPiSetup() == -1){
            printf("setup wiringPi failed !");
            return 1;
        }
        
        pinMode(LedPin, OUTPUT);
        pinMode(ButtonPin, INPUT);
        digitalWrite(LedPin, HIGH);
        
        while(1){
            // Indica que el bot贸n ha sido presionado
            if(digitalRead(ButtonPin) == 0){
                // Enciende el LED
                digitalWrite(LedPin, LOW);
            //  printf("...LED encendido\n");
            }
            else{
                // Apaga el LED
                digitalWrite(LedPin, HIGH);
            //  printf("LED apagado...\n");
            }
        }
        return 0;
    }

**Explicaci贸n del C贸digo**

.. code-block:: 

    #define LedPin      0

El pin GPIO17 en la placa T_Extension es equivalente al GPIO0 en wiringPi.

.. code-block:: 

    #define ButtonPin   1

ButtonPin est谩 conectado al GPIO1.

.. code-block:: 

    pinMode(LedPin, OUTPUT);

Configura LedPin como salida para asignarle un valor.

.. code-block:: 

    pinMode(ButtonPin, INPUT);

Configura ButtonPin como entrada para leer su valor.

.. code-block:: C

    while(1){
            // Indica que el bot贸n ha sido presionado
            if(digitalRead(ButtonPin) == 0){
                // Enciende el LED
                digitalWrite(LedPin, LOW);
            //  printf("...LED encendido\n");
            }
            else{
                // Apaga el LED
                digitalWrite(LedPin, HIGH);
            //  printf("LED apagado...\n");
            }
        }


if (digitalRead(ButtonPin) == 0): verifica si el bot贸n ha sido presionado. 
Ejecuta digitalWrite(LedPin, LOW) cuando el bot贸n es presionado para encender 
el LED.


Para Usuarios de Lenguaje Python
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

**Paso 2**: Abre el archivo de c贸digo.

.. raw:: html

   <run></run>

.. code-block:: 

    cd ~/davinci-kit-for-raspberry-pi/python

**Paso 3**: Ejecuta el c贸digo.

.. raw:: html

   <run></run>

.. code-block:: 

    sudo python3 2.1.1_Button.py

Ahora, presiona el bot贸n y el LED se encender谩; presiona el bot贸n 
nuevamente y el LED se apagar谩. Al mismo tiempo, el estado del LED 
se mostrar谩 en la pantalla.

**C贸digo**

.. note::

    Puedes **Modificar/Restablecer/Copiar/Ejecutar/Detener** el c贸digo a continuaci贸n. Antes de eso, necesitas dirigirte a la ruta del c贸digo fuente como ``davinci-kit-for-raspberry-pi/python``.
    
.. raw:: html

    <run></run>

.. code-block:: python

    import RPi.GPIO as GPIO
    import time

    LedPin = 17 # Configura GPIO17 como el pin del LED
    BtnPin = 18 # Configura GPIO18 como el pin del bot贸n


    Led_status = True # Configura el estado inicial del LED como True (APAGADO)

    # Define una funci贸n de configuraci贸n inicial
    def setup(): 
        # Configura los modos GPIO al sistema de numeraci贸n BCM
        GPIO.setmode(GPIO.BCM) 
        GPIO.setup(LedPin, GPIO.OUT, initial=GPIO.HIGH)  # Configura LedPin como salida y el nivel inicial como alto (3.3V)
        GPIO.setup(BtnPin, GPIO.IN) # Configura BtnPin como entrada.

    # Define una funci贸n de callback para el bot贸n
    def swLed(ev=None): 
        global Led_status 
        # Cambia el estado del LED (encendido-->apagado; apagado-->encendido)
        Led_status = not Led_status 
        GPIO.output(LedPin, Led_status) 
        if Led_status: 
            print ('LED OFF...')
        else: 
            print ('...LED ON')

    # Define la funci贸n principal del proceso
    def main(): 
        # Configura una detecci贸n de ca铆da en BtnPin,  
        # y la funci贸n de callback swLed
        GPIO.add_event_detect(BtnPin, GPIO.FALLING, callback=swLed) 
        while True: 
            # No realizar ninguna acci贸n
            time.sleep(1) 

    # Define una funci贸n destroy para limpiar todo despu茅s de
    # que el script termine
    def destroy(): 
        # Apaga el LED
        GPIO.output(LedPin, GPIO.HIGH) 
        # Libera los recursos
        GPIO.cleanup() 

    # Si ejecutas este script directamente, haz:
    if __name__ == '__main__': 
        setup() 
        try: 
            main() 
        # Cuando se presiona 'Ctrl+C', se ejecutar谩 la funci贸n
        # destroy()
        except KeyboardInterrupt: 
            destroy() 

**Explicaci贸n del C贸digo**

.. code-block:: python

    LedPin = 17 

Configura GPIO17 como el pin del LED.

.. code-block:: python

    BtnPin = 18 

Configura GPIO18 como el pin del bot贸n.

.. code-block:: python

    GPIO.add_event_detect(BtnPin, GPIO.FALLING, callback=swLed) 

Configura una detecci贸n de ca铆da en BtnPin, de manera que cuando el 
valor de BtnPin cambie de alto a bajo, esto indica que el bot贸n fue 
presionado. El siguiente paso es llamar a la funci贸n swLed.

.. code-block:: python

    def swLed(ev=None): 
    global Led_status 
    # Cambia el estado del LED (encendido-->apagado; apagado-->encendido)
    Led_status = not Led_status 
    GPIO.output(LedPin, Led_status) 

Define una funci贸n de callback para el bot贸n. Cuando se presiona el bot贸n 
por primera vez, y la condici贸n `not Led_status` es falsa, la funci贸n GPIO.
output() se llama para encender el LED. Al presionar el bot贸n nuevamente, el 
estado del LED se convierte de falso a verdadero, y el LED se apagar谩.


Imagen del Fen贸meno
------------------------

.. image:: img/image153.jpeg


