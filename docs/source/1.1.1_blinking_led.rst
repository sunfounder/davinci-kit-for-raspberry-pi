.. note::

    춰Hola! Bienvenido a la comunidad de entusiastas de SunFounder para Raspberry Pi, Arduino y ESP32 en Facebook. 칔nete a otros apasionados y profundiza en el mundo de Raspberry Pi, Arduino y ESP32.

    **쯇or qu칠 unirte?**

    - **Soporte Experto**: Resuelve problemas posventa y supera desaf칤os t칠cnicos con el apoyo de nuestra comunidad y equipo.
    - **Aprende y Comparte**: Intercambia consejos y tutoriales para mejorar tus habilidades.
    - **Acceso Exclusivo**: Obt칠n acceso anticipado a anuncios de nuevos productos y adelantos especiales.
    - **Descuentos Especiales**: Disfruta de descuentos exclusivos en nuestros productos m치s recientes.
    - **Promociones Festivas y Sorteos**: Participa en sorteos y promociones durante las festividades.

    游녤 쯃isto para explorar y crear con nosotros? Haz clic en [|link_sf_facebook|] y 칰nete hoy.

1.1.1 LED Parpadeante
=========================

Introducci칩n
-----------------

En esta lecci칩n, aprenderemos a hacer parpadear un LED mediante programaci칩n.
Con tus ajustes, tu LED puede producir una serie de efectos interesantes. 춰Manos a la obra!

Componentes
------------------

.. image:: img/blinking_led_list.png
    :width: 800
    :align: center


.. note::
    Para proceder sin problemas, necesitas contar con tu propia
    Raspberry Pi, tarjeta TF y fuente de alimentaci칩n para Raspberry Pi.


Principio
--------------

**Protoboard**

Una protoboard es una base de construcci칩n para el prototipado de circuitos electr칩nicos. Se
usa para construir y probar circuitos r치pidamente antes de finalizar cualquier dise침o de circuito. 
Tiene muchos orificios en los que se pueden insertar componentes como ICs, resistencias y cables de puente. 
La protoboard permite conectar y retirar componentes f치cilmente.

La imagen muestra la estructura interna de una protoboard completa. Aunque
estos orificios en la protoboard parecen independientes entre s칤,
en realidad est치n conectados mediante tiras de metal internamente.

.. image:: img/image41.png

**LED**

El LED es un tipo de diodo. Solo brillar치 si el pin largo del LED est치
conectado al electrodo positivo y el pin corto est치 conectado al electrodo negativo.

.. |image42| image:: img/image42.png

.. |image43| image:: img/image43.png

|image42|\ |image43|

El LED no se puede conectar directamente a la fuente de alimentaci칩n, lo cual podr칤a da침ar
el componente. Se debe conectar una resistencia de 160풜 o mayor (funcionando a 5V) en
serie en el circuito del LED.



**Resistencia**

La resistencia es un componente electr칩nico que puede limitar la corriente en una rama del circuito. Una
resistencia fija es un tipo de resistencia cuyo valor no puede cambiarse, mientras que el de un potenci칩metro
o resistencia variable s칤 se puede ajustar.

En este kit se utiliza una resistencia fija. En el circuito, es esencial para proteger
los componentes conectados. Las siguientes im치genes muestran una resistencia de 220풜
y dos s칤mbolos de circuito com칰nmente utilizados. 풜 es la unidad de resistencia y las unidades mayores incluyen K풜,
M풜, etc. Su relaci칩n es: 1 M풜=1000 K풜, 1 K풜 = 1000 풜. Normalmente, el valor de resistencia se marca en ella.
As칤 que si ves estos s칤mbolos en un circuito, significa que hay una resistencia.

.. image:: img/image44.png

.. |image45| image:: img/image45.png

.. |image46| image:: img/image46.png

|image45|\ |image46|

Al usar una resistencia, necesitamos saber su valor de resistencia. Aqu칤 hay dos m칠todos:
observar las bandas en la resistencia o usar un mult칤metro para medir la resistencia.
Se recomienda el primer m칠todo por ser m치s conveniente y r치pido. Para medir el valor, usa un mult칤metro.
Como se muestra en la tarjeta, cada color representa un n칰mero.

.. image:: img/image47.jpeg

Diagrama Esquem치tico
------------------------

En este experimento, conecta una resistencia de 220풜 al 치nodo (el pin largo del LED),
luego conecta la resistencia a 3.3 V y conecta el c치todo (el pin corto) del LED a GPIO17 de Raspberry Pi. 
Por lo tanto, para encender un LED, necesitamos configurar GPIO17 en nivel bajo (0V). 
Podemos lograr esto mediante programaci칩n.

.. note::

    **Pin11** se refiere al 11췈 pin de la Raspberry Pi de izquierda a derecha, y sus correspondientes n칰meros de pin en **wiringPi** y **BCM** se muestran en la siguiente tabla.

En el contenido relacionado con el lenguaje C, hacemos que GPIO0 sea 
equivalente a 0 en wiringPi. En el contenido relacionado con el lenguaje 
Python, BCM 17 es 17 en la columna BCM de la siguiente tabla. Al mismo tiempo, 
es el mismo que el 11췈 pin en la Raspberry Pi, Pin 11.

============ ======== ======== ====
T-Board Name physical wiringPi BCM
GPIO17       Pin 11   0        17
============ ======== ======== ====

.. image:: img/image48.png
    :width: 800
    :align: center


Procedimientos Experimentales
---------------------------------

**Paso 1:** Construye el circuito.

.. image:: img/image49.png
    :width: 800
    :align: center

Para Usuarios del Lenguaje C
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

**Paso 2:** Dir칤gete a la carpeta del c칩digo.

1) Si usas una pantalla, te recomendamos seguir los siguientes pasos.

Ve a **~/** y encuentra la carpeta **davinci-kit-for-raspberry-pi**.

Encuentra **C** en la carpeta, haz clic derecho sobre ella y selecciona **Abrir en Terminal**.

.. image:: img/image50.png
    :width: 800
    :align: center

Aparecer치 una ventana como se muestra a continuaci칩n. Ahora has ingresado en la ruta del c칩digo **1.1.1_BlinkingLed.c**.

.. image:: img/image51.png
    :width: 800
    :align: center

En las lecciones siguientes, usaremos el comando para acceder al archivo de 
c칩digo en lugar de hacer clic derecho. Pero puedes elegir el m칠todo que prefieras.

2) Si inicias sesi칩n en la Raspberry Pi de forma remota, usa ``cd`` para cambiar de directorio:

.. raw:: html

   <run></run>

.. code-block::

   cd ~/davinci-kit-for-raspberry-pi/c/1.1.1/

.. note::
    Cambia el directorio a la ruta del c칩digo en este experimento mediante cd.

De cualquier manera, ahora est치s en la carpeta C. Los procedimientos posteriores 
basados en estos dos m칠todos son los mismos. Continuemos.

**Paso 3:** Compila el c칩digo

.. raw:: html

   <run></run>

.. code-block::

   gcc 1.1.1_BlinkingLed.c -o BlinkingLed -lwiringPi

.. note::
    gcc es la Colecci칩n de Compiladores de GNU. Aqu칤, funciona como compilador 
    para el archivo en lenguaje C *1_BlinkingLed.c* y produce un archivo 
    ejecutable.

En el comando, ``-o`` significa salida (el car치cter inmediatamente despu칠s de 
-o es el nombre del archivo generado tras la compilaci칩n, y aqu칤 se crear치 un 
ejecutable llamado ``BlinkingLed``) y ``-lwiringPi`` es para cargar la biblioteca 
wiringPi (``l`` es la abreviatura de biblioteca).

**Paso 4:** Ejecuta el archivo ejecutable generado en el paso anterior.

.. raw:: html

   <run></run>

.. code-block::

   sudo ./BlinkingLed

.. note::

   Para controlar el GPIO, necesitas ejecutar el programa con el comando 
   sudo (superuser do). El comando ``./`` indica el directorio actual. 
   Todo el comando ejecuta el archivo ``BlinkingLed`` en el directorio actual.

.. image:: img/image52.png
    :width: 800
    :align: center

Despu칠s de ejecutar el c칩digo, ver치s el LED parpadeando.

.. note::

   Si no funciona despu칠s de ejecutarlo o aparece un error: \"wiringPi.h: No such file or directory\", consulta :ref:`C code is not working?`.

Si deseas editar el archivo de c칩digo ``1.1.1_BlinkingLed.c``, presiona 
``Ctrl + C`` para detener la ejecuci칩n del c칩digo. Luego escribe el siguiente 
comando para abrirlo:

.. raw:: html

   <run></run>

.. code-block::

   nano 1.1.1_BlinkingLed.c

.. note::
    nano es una herramienta de edici칩n de texto. El comando se usa para abrir 
    el archivo de c칩digo ``1.1.1_BlinkingLed.c`` con esta herramienta.

Presiona ``Ctrl+X`` para salir. Si has modificado el c칩digo, aparecer치 un mensaje 
preguntando si deseas guardar los cambios. Escribe ``Y`` (guardar) o ``N`` (no guardar). 
Luego presiona ``Enter`` para salir. Repite ``Paso 3`` y ``Paso 4`` para ver el efecto tras modificar.

.. image:: img/image53.png
    :width: 800
    :align: center

**C칩digo**

El c칩digo del programa se muestra a continuaci칩n:

.. code-block:: c

   #include <wiringPi.h>  
   #include <stdio.h>
   #define LedPin      0
   int main(void)
   {
      // Si falla la inicializaci칩n de wiring, imprime un mensaje en la pantalla
      if(wiringPiSetup() == -1){
         printf("setup wiringPi failed !");
         return 1;
      }
      pinMode(LedPin, OUTPUT); // Configura LedPin como salida para escribir valor en 칠l.
      while(1){
         // LED encendido
         digitalWrite(LedPin, LOW);
         printf("...LED on\n");
         delay(500);
         // LED apagado
         digitalWrite(LedPin, HIGH);
         printf("LED off...\n");
         delay(500);
      }
      return 0;
   }

**Explicaci칩n del C칩digo**

.. code-block:: c

   include <wiringPi.h>

La biblioteca de control de hardware est치 dise침ada para el lenguaje C de 
Raspberry Pi. Agregar esta biblioteca facilita la inicializaci칩n del hardware 
y la salida de puertos de E/S, PWM, etc.

.. code-block:: c

   #include <stdio.h>

Biblioteca est치ndar de E/S. La funci칩n printf, utilizada para imprimir los 
datos en pantalla, est치 implementada en esta biblioteca. Existen muchas otras 
funciones 칰tiles que puedes explorar.

.. code-block:: c

   #define LedPin 0

El pin GPIO17 de la placa de extensi칩n T corresponde a GPIO0 en wiringPi. 
Asigna GPIO0 a LedPin, y LedPin representar치 GPIO0 en el c칩digo m치s adelante.

.. code-block:: c

    if(wiringPiSetup() == -1){
        printf("setup wiringPi failed !");
        return 1;

Esta l칤nea inicializa wiringPi y asume que el programa en uso emplear치 el 
esquema de numeraci칩n de pines de wiringPi.

Esta funci칩n necesita ser llamada con privilegios de root. Cuando la 
inicializaci칩n de wiring falla, imprime un mensaje en la pantalla. 
La funci칩n "return" se usa para salir de la funci칩n actual. Utilizar 
"return" en main() finalizar치 el programa.

.. code-block:: c

   pinMode(LedPin, OUTPUT);

Configura LedPin como salida para poder escribir un valor en 칠l.

.. code-block:: c

   digitalWrite(LedPin, LOW);

Configura GPIO0 a 0V (nivel bajo). Dado que el c치todo del LED est치 conectado 
a GPIO0, el LED se encender치 si GPIO0 est치 en bajo. Por el contrario, al 
configurar GPIO0 en nivel alto con digitalWrite(LedPin, HIGH), el LED se apagar치.

.. code-block:: c

   printf("...LED맖ff\n");

La funci칩n printf es una funci칩n est치ndar de la biblioteca y su prototipo 
est치 en el archivo de encabezado "stdio.h". La forma general de la llamada 
es: printf("cadena de control de formato", columnas de salida). La cadena 
de control de formato especifica el formato de salida y se divide en cadena 
con formato y sin formato. La cadena con formato empieza con '%' seguido de 
caracteres de formato, como '%d' para salida de enteros decimales. 
Las cadenas sin formato se imprimen como est치n. Aqu칤 se usa una cadena sin 
formato, seguida de "\n", un car치cter de nueva l칤nea que indica un salto de 
l칤nea autom치tico despu칠s de imprimir la cadena.

.. code-block:: c

   delay(500);

Delay (500) mantiene el estado actual en ALTO o BAJO durante 500 ms.

Esta funci칩n pausa el programa por un per칤odo de tiempo. La velocidad del 
programa est치 determinada por el hardware. Aqu칤 encendemos o apagamos el LED. 
Sin la funci칩n de retardo, el programa ejecutar칤a r치pidamente el ciclo completo, 
por lo que necesitamos esta funci칩n para ayudarnos a escribir y depurar el programa.

.. code-block:: c

   return 0;

Generalmente, se coloca al final de la funci칩n principal, indicando que la funci칩n devuelve 0 tras una ejecuci칩n exitosa.

Para Usuarios de Python
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

**Paso 2:** Ve a la carpeta del c칩digo y ejec칰talo.

1. Si utilizas una pantalla, se recomienda seguir estos pasos:

Busca **1.1.1_BlinkingLed.py** y haz doble clic para abrirlo. Ahora est치s en el archivo.

Haz clic en **Run** -> **Run Module** en la ventana, y aparecer치n los siguientes contenidos.

Para detener la ejecuci칩n, haz clic en el bot칩n X en la esquina superior 
derecha para cerrarlo, y regresar치s al c칩digo. Si modificas el c칩digo, 
antes de hacer clic en **Run Module (F5)**, aseg칰rate de guardarlo primero. 
Luego podr치s ver los resultados.

2. Si accedes a la Raspberry Pi de forma remota, escribe el siguiente comando:

.. raw:: html

   <run></run>

.. code-block::

   cd ~/davinci-kit-for-raspberry-pi/python

.. note::
    Cambia el directorio a la ruta del c칩digo de este experimento mediante ``cd``.

**Paso 3:** Ejecuta el c칩digo

.. raw:: html

   <run></run>

.. code-block::

   sudo python3 1.1.1_BlinkingLed.py

.. note::
    Aqu칤, sudo - superuser do, y python indica que el archivo se ejecuta con Python.

Al ejecutar el c칩digo, ver치s que el LED parpadea.

**Paso 4:** Si deseas editar el archivo de c칩digo 1.1.1_BlinkingLed.py,
presiona ``Ctrl + C`` para detener la ejecuci칩n del c칩digo. Luego escribe 
el siguiente comando para abrir 1.1.1_BlinkingLed.py:

.. raw:: html

   <run></run>

.. code-block::

   nano 1.1.1_BlinkingLed.py

.. note::
    nano es una herramienta de edici칩n de texto. El comando se utiliza para 
    abrir el archivo de c칩digo 1.1.1_BlinkingLed.py con esta herramienta.

Presiona ``Ctrl+X`` para salir. Si has modificado el c칩digo, aparecer치 un 
mensaje preguntando si deseas guardar los cambios. Escribe ``Y`` (guardar) o ``N`` (no guardar).

Luego presiona ``Enter`` para salir. Escribe nuevamente ``nano 1.1.1_BlinkingLed.py`` para ver el efecto tras el cambio.

**C칩digo**

.. note::

   Puedes **Modificar/Restablecer/Copiar/Ejecutar/Detener** el c칩digo a continuaci칩n. Pero antes de eso, debes dirigirte a la ruta del c칩digo fuente como ``davinci-kit-for-raspberry-pi/python``.

.. raw:: html

   <run></run>

.. code-block:: python

   import RPi.GPIO as GPIO
   import time
   LedPin = 17
   def setup():
      # Configura el modo GPIO en numeraci칩n BCM
      GPIO.setmode(GPIO.BCM)
      # Configura LedPin como salida y nivel inicial en alto (3.3V)
      GPIO.setup(LedPin, GPIO.OUT, initial=GPIO.HIGH)
   # Define la funci칩n principal para el proceso principal
   def main():
      while True:
         print ('...LED ON')
         # Enciende el LED
         GPIO.output(LedPin, GPIO.LOW)
         time.sleep(0.5)
         print ('LED OFF...')
         # Apaga el LED
         GPIO.output(LedPin, GPIO.HIGH)
         time.sleep(0.5)
   # Define la funci칩n destroy para limpiar todo despu칠s de finalizar el script
   def destroy():
      # Apaga el LED
      GPIO.output(LedPin, GPIO.HIGH)
      # Libera recursos
      GPIO.cleanup()                   
   # Si se ejecuta este script directamente, haz lo siguiente:
   if __name__ == '__main__':
      setup()
      try:
         main()
      # Cuando se presiona 'Ctrl+C', el programa ejecutar치 destroy().
      except KeyboardInterrupt:
         destroy()

**Explicaci칩n del C칩digo**

.. code-block:: python

   #!/usr/bin/env python3

Cuando el sistema detecta esto, buscar치 la ruta de instalaci칩n de Python 
en la configuraci칩n de env y luego llamar치 al int칠rprete correspondiente 
para completar la operaci칩n. Esto evita que el usuario no instale Python 
en la ruta predeterminada /usr/bin.

.. code-block:: python

   import RPi.GPIO as GPIO

De esta manera, se importa la biblioteca RPi.GPIO, luego se define una 
variable, GPIO, para reemplazar RPI.GPIO en el c칩digo siguiente.

.. code-block:: python

   import time

Importa el paquete time, para funciones de retardo de tiempo en el programa siguiente.

.. code-block:: python

   LedPin = 17

El LED se conecta al GPIO17 de la placa de extensi칩n en forma de T, es decir, BCM 17.

.. code-block:: python

   def setup():
      GPIO.setmode(GPIO.BCM)
      GPIO.setup(LedPin, GPIO.OUT, initial=GPIO.HIGH)

Configura LedPin en modo de salida y nivel inicial en alto (3.3V).

Hay dos maneras de numerar los pines IO en una Raspberry Pi dentro de RPi.GPIO: 
n칰meros BOARD y n칰meros BCM. En nuestras lecciones, utilizamos n칰meros BCM. 
Debes configurar cada canal que est치s usando como entrada o salida.

.. code-block:: python

   GPIO.output(LedPin, GPIO.LOW)

Configura GPIO17 (BCM17) en 0V (nivel bajo). Como el c치todo del LED est치 
conectado a GPIO17, el LED se encender치.

.. code-block:: python

   time.sleep(0.5)

Retrasa 0.5 segundos. Aqu칤, la declaraci칩n es una funci칩n de retardo en lenguaje C, la unidad es segundos.

.. code-block:: python

   def destroy():
      GPIO.cleanup()  

Define una funci칩n destroy para limpiar todo despu칠s de que el script termine.

.. code-block:: python

   if __name__ == '__main__':
      setup()
      try:
         main()
      # Cuando se presiona 'Ctrl+C', el programa destroy() ser치 ejecutado.
      except KeyboardInterrupt:
         destroy()

Esta es la estructura general de ejecuci칩n del c칩digo. Cuando el programa 
comienza a ejecutarse, inicializa el pin ejecutando setup(), y luego ejecuta 
el c칩digo en la funci칩n main() para establecer el pin en niveles altos y bajos. 
Cuando se presiona 'Ctrl+C', el programa ejecutar치 destroy().

Imagen del Fen칩meno
-----------------------

.. image:: img/image54.jpeg
    :width: 800
    :align: center