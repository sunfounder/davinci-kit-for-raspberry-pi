<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>3.1.2 Welcome &mdash; SunFounder davinci-kit-for-raspberry-pi  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="https://ezblock.cc/readDocFile/custom.css" type="text/css" />
      <link rel="stylesheet" href="https://ezblock.cc/readDocFile/readTheDoc/src/css/index.css" type="text/css" />
      <link rel="stylesheet" href="https://ezblock.cc/readDocFile/readTheDoc/src/css/xterm.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
        <script src="https://ezblock.cc/readDocFile/custom.js"></script>
        <script src="../_static/./lang.js"></script>
        <script src="https://ezblock.cc/readDocFile/readTheDoc/src/js/ace.js"></script>
        <script src="https://ezblock.cc/readDocFile/readTheDoc/src/js/ext-language_tools.js"></script>
        <script src="https://ezblock.cc/readDocFile/readTheDoc/src/js/theme-chrome.js"></script>
        <script src="https://ezblock.cc/readDocFile/readTheDoc/src/js/mode-python.js"></script>
        <script src="https://ezblock.cc/readDocFile/readTheDoc/src/js/mode-sh.js"></script>
        <script src="https://ezblock.cc/readDocFile/readTheDoc/src/js/monokai.js"></script>
        <script src="https://ezblock.cc/readDocFile/readTheDoc/src/js/xterm.js"></script>
        <script src="https://ezblock.cc/readDocFile/readTheDoc/src/js/FitAddon.js"></script>
        <script src="https://ezblock.cc/readDocFile/readTheDoc/src/js/readTheDocIndex.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="3.1.3 Reversing Alarm" href="pi5_3.1.3_reversing_alarm_python.html" />
    <link rel="prev" title="3.1.1 Counting Device" href="pi5_3.1.1_counting_device_python.html" /> 
</head>

<body class="wy-body-for-nav">
<nav id="nav-bar">
  <ul class="nav-bar-items" id="nav-bar-items">
    <li class="nav-bar-logo">
      <a href="https://sunfounder.com">
        <img class="logo-img" src="https://ezblock.cc/readDocFile/sunfounder_LOGO_160x@2x.png"/>
      </a>
    </li>
  </ul>
</nav>

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            SunFounder davinci-kit-for-raspberry-pi
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index.html">About this Kit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../component_list.html">Component List</a></li>
<li class="toctree-l1"><a class="reference internal" href="../libraries.html">Libraries</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gpio_extension_board.html">GPIO Extension Board</a></li>
<li class="toctree-l1"><a class="reference internal" href="../download_the_code.html">Download the Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="../preparation/preparation.html">Preparation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../for_pi5.html">For Pi 5</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="play_with_python_pi5.html">Play with Python</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="check_the_gpiozero_python.html">Check the <code class="docutils literal notranslate"><span class="pre">GPIO</span> <span class="pre">Zero</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="pi5_output_python.html">Output</a></li>
<li class="toctree-l3"><a class="reference internal" href="pi5_input_python.html">Input</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="pi5_extension_python.html">Extension</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="pi5_3.1.1_counting_device_python.html">3.1.1 Counting Device</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">3.1.2 Welcome</a></li>
<li class="toctree-l4"><a class="reference internal" href="pi5_3.1.3_reversing_alarm_python.html">3.1.3 Reversing Alarm</a></li>
<li class="toctree-l4"><a class="reference internal" href="pi5_3.1.4_smart_fan_python.html">3.1.4 Smart Fan</a></li>
<li class="toctree-l4"><a class="reference internal" href="pi5_3.1.5_battery_indicator_python.html">3.1.5 Battery Indicator</a></li>
<li class="toctree-l4"><a class="reference internal" href="pi5_3.1.6_motion_control_python.html">3.1.6 Motion Control</a></li>
<li class="toctree-l4"><a class="reference internal" href="pi5_3.1.7_traffic_light_python.html">3.1.7 Traffic Light</a></li>
<li class="toctree-l4"><a class="reference internal" href="pi5_3.1.8_overheat_monitor_python.html">3.1.8 Overheat Monitor</a></li>
<li class="toctree-l4"><a class="reference internal" href="pi5_3.1.9_password_lock_python.html">3.1.9 Password Lock</a></li>
<li class="toctree-l4"><a class="reference internal" href="pi5_3.1.10_alarm_bell_python.html">3.1.10 Alarm Bell</a></li>
<li class="toctree-l4"><a class="reference internal" href="pi5_3.1.11_morse_code_generator_python.html">3.1.11 Morse Code Generator</a></li>
<li class="toctree-l4"><a class="reference internal" href="pi5_3.1.12_game_guess_number_python.html">3.1.12 GAME‚Äì Guess Number</a></li>
<li class="toctree-l4"><a class="reference internal" href="pi5_3.1.13_game_10_second_python.html">3.1.13 GAME - 10 Second</a></li>
<li class="toctree-l4"><a class="reference internal" href="pi5_3.1.14_game_not_not_python.html">3.1.14 GAME‚Äì Not Not</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../c_pi5/play_with_c.html">Play with C</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scratch_pi5/play_with_scratch.html">Play with Scratch</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../for_other_models.html">For Pi 4, 3, and All Other Pi Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python_video/python_video.html">Python Video Course</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendix/appendix.html">Appendix</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../thank-learning.html">Thank You</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">SunFounder davinci-kit-for-raspberry-pi</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../for_pi5.html">For Pi 5</a></li>
          <li class="breadcrumb-item"><a href="play_with_python_pi5.html">Play with Python</a></li>
          <li class="breadcrumb-item"><a href="pi5_extension_python.html">Extension</a></li>
      <li class="breadcrumb-item active">3.1.2 Welcome</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/python_pi5/pi5_3.1.2_welcome_python.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="admonition note">
<p class="admonition-title">Note</p>
<p>Hello, welcome to the SunFounder Raspberry Pi &amp; Arduino &amp; ESP32 Enthusiasts Community on Facebook! Dive deeper into Raspberry Pi, Arduino, and ESP32 with fellow enthusiasts.</p>
<p><strong>Why Join?</strong></p>
<ul class="simple">
<li><p><strong>Expert Support</strong>: Solve post-sale issues and technical challenges with help from our community and team.</p></li>
<li><p><strong>Learn &amp; Share</strong>: Exchange tips and tutorials to enhance your skills.</p></li>
<li><p><strong>Exclusive Previews</strong>: Get early access to new product announcements and sneak peeks.</p></li>
<li><p><strong>Special Discounts</strong>: Enjoy exclusive discounts on our newest products.</p></li>
<li><p><strong>Festive Promotions and Giveaways</strong>: Take part in giveaways and holiday promotions.</p></li>
</ul>
<p>üëâ Ready to explore and create with us? Click [<a href="https://bit.ly/raphaelkit " target="_blank">here</a>] and join today!</p>
</div>
<section id="welcome">
<span id="py-pi5-welcome"></span><h1>3.1.2 Welcome<a class="headerlink" href="#welcome" title="Permalink to this heading">ÔÉÅ</a></h1>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this heading">ÔÉÅ</a></h2>
<p>In this project, we will use PIR to sense the movement of pedestrians,
and use servos, LED, buzzer to simulate the work of the sensor door of
the convenience store. When the pedestrian appears within the sensing
range of the PIR, the indicator light will be on, the door will be
opened, and the buzzer will play the opening bell.</p>
</section>
<section id="required-components">
<h2>Required Components<a class="headerlink" href="#required-components" title="Permalink to this heading">ÔÉÅ</a></h2>
<p>In this project, we need the following components.</p>
<a class="reference internal image-reference" href="../_images/4.1.8_welcome_list.png"><img alt="../_images/4.1.8_welcome_list.png" class="align-center" src="../_images/4.1.8_welcome_list.png" style="width: 800px;" /></a>
</section>
<section id="schematic-diagram">
<h2>Schematic Diagram<a class="headerlink" href="#schematic-diagram" title="Permalink to this heading">ÔÉÅ</a></h2>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>T-Board Name</p></td>
<td><p>physical</p></td>
<td><p>wiringPi</p></td>
<td><p>BCM</p></td>
</tr>
<tr class="row-even"><td><p>GPIO18</p></td>
<td><p>Pin 12</p></td>
<td><p>1</p></td>
<td><p>18</p></td>
</tr>
<tr class="row-odd"><td><p>GPIO17</p></td>
<td><p>Pin 11</p></td>
<td><p>0</p></td>
<td><p>17</p></td>
</tr>
<tr class="row-even"><td><p>GPIO27</p></td>
<td><p>Pin 13</p></td>
<td><p>2</p></td>
<td><p>27</p></td>
</tr>
<tr class="row-odd"><td><p>GPIO22</p></td>
<td><p>Pin 15</p></td>
<td><p>3</p></td>
<td><p>22</p></td>
</tr>
</tbody>
</table>
<img alt="../_images/4.1.8_welcome_schematic.png" class="align-center" src="../_images/4.1.8_welcome_schematic.png" />
</section>
<section id="experimental-procedures">
<h2>Experimental Procedures<a class="headerlink" href="#experimental-procedures" title="Permalink to this heading">ÔÉÅ</a></h2>
<p><strong>Step 1:</strong> Build the circuit.</p>
<img alt="../_images/4.1.8_welcome_circuit.png" class="align-center" src="../_images/4.1.8_welcome_circuit.png" />
<p><strong>Step 2:</strong> Change directory.</p>
<run></run><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">~/</span><span class="n">raphael</span><span class="o">-</span><span class="n">kit</span><span class="o">/</span><span class="n">python</span><span class="o">-</span><span class="n">pi5</span>
</pre></div>
</div>
<p><strong>Step 3:</strong> Run.</p>
<run></run><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">python3</span> <span class="mf">3.1.2</span><span class="n">_Welcome</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>After the code runs, if the PIR sensor detects someone passing by, the
door will automatically open (simulated by the servo), turn on the
indicator and play the doorbell music. After the doorbell music plays,
the system will automatically close the door and turn off the indicator
light, waiting for the next time someone passes by.</p>
<p>There are two potentiometers on the PIR module: one is to adjust sensitivity and the other is to adjust the detection distance. To make the PIR module work better, you You need to turn both of them counterclockwise to the end.</p>
<a class="reference internal image-reference" href="../_images/4.1.8_PIR_TTE.png"><img alt="../_images/4.1.8_PIR_TTE.png" class="align-center" src="../_images/4.1.8_PIR_TTE.png" style="width: 400px;" /></a>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If there is an error prompt  <code class="docutils literal notranslate"><span class="pre">RuntimeError:</span> <span class="pre">Cannot</span> <span class="pre">determine</span> <span class="pre">SOC</span> <span class="pre">peripheral</span> <span class="pre">base</span> <span class="pre">address</span></code>, please refer to <a class="reference internal" href="../faq.html#faq-soc"><span class="std std-ref">If gpiozero doesn‚Äôt work.</span></a></p>
</div>
<p><strong>Code</strong></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You can <strong>Modify/Reset/Copy/Run/Stop</strong> the code below. But before that, you need to go to  source code path like <code class="docutils literal notranslate"><span class="pre">raphael-kit/python-pi5</span></code>. After modifying the code, you can run it directly to see the effect.</p>
</div>
<run></run><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env python3</span>

<span class="kn">from</span> <span class="nn">gpiozero</span> <span class="kn">import</span> <span class="n">LED</span><span class="p">,</span> <span class="n">MotionSensor</span><span class="p">,</span> <span class="n">Servo</span><span class="p">,</span> <span class="n">TonalBuzzer</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="c1"># GPIO pin setup for LED, motion sensor (PIR), and buzzer</span>
<span class="n">ledPin</span> <span class="o">=</span> <span class="n">LED</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="n">pirPin</span> <span class="o">=</span> <span class="n">MotionSensor</span><span class="p">(</span><span class="mi">21</span><span class="p">)</span>
<span class="n">buzPin</span> <span class="o">=</span> <span class="n">TonalBuzzer</span><span class="p">(</span><span class="mi">27</span><span class="p">)</span>

<span class="c1"># Servo motor pulse width correction factor and calculation</span>
<span class="n">myCorrection</span> <span class="o">=</span> <span class="mf">0.45</span>
<span class="n">maxPW</span> <span class="o">=</span> <span class="p">(</span><span class="mf">2.0</span> <span class="o">+</span> <span class="n">myCorrection</span><span class="p">)</span> <span class="o">/</span> <span class="mi">1000</span>  <span class="c1"># Maximum pulse width</span>
<span class="n">minPW</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">myCorrection</span><span class="p">)</span> <span class="o">/</span> <span class="mi">1000</span>  <span class="c1"># Minimum pulse width</span>

<span class="c1"># Initialize servo with custom pulse widths</span>
<span class="n">servoPin</span> <span class="o">=</span> <span class="n">Servo</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="n">min_pulse_width</span><span class="o">=</span><span class="n">minPW</span><span class="p">,</span> <span class="n">max_pulse_width</span><span class="o">=</span><span class="n">maxPW</span><span class="p">)</span>

<span class="c1"># Musical tune for buzzer, with notes and durations</span>
<span class="n">tune</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;C#4&#39;</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;D4&#39;</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">),</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;Eb4&#39;</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;E4&#39;</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">),</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;F#4&#39;</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;G4&#39;</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">),</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;Eb4&#39;</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;E4&#39;</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">),</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;F#4&#39;</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;G4&#39;</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">),</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;C4&#39;</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;B4&#39;</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">),</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;F#4&#39;</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;G4&#39;</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">),</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;B4&#39;</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;Bb4&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;A4&#39;</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;G4&#39;</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;E4&#39;</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;D4&#39;</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;E4&#39;</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">)]</span>

<span class="k">def</span> <span class="nf">setAngle</span><span class="p">(</span><span class="n">angle</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Move the servo to a specified angle.</span>
<span class="sd">    :param angle: Angle in degrees (0-180).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">angle</span> <span class="o">/</span> <span class="mi">180</span><span class="p">)</span>  <span class="c1"># Convert angle to servo value</span>
    <span class="n">servoPin</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>      <span class="c1"># Set servo position</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.001</span><span class="p">)</span>           <span class="c1"># Short delay for servo movement</span>

<span class="k">def</span> <span class="nf">doorbell</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Play a musical tune using the buzzer.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">note</span><span class="p">,</span> <span class="n">duration</span> <span class="ow">in</span> <span class="n">tune</span><span class="p">:</span>
        <span class="n">buzPin</span><span class="o">.</span><span class="n">play</span><span class="p">(</span><span class="n">note</span><span class="p">)</span>       <span class="c1"># Play the note</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">duration</span><span class="p">))</span>  <span class="c1"># Duration of the note</span>
    <span class="n">buzPin</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>               <span class="c1"># Stop buzzer after playing the tune</span>

<span class="k">def</span> <span class="nf">closedoor</span><span class="p">():</span>
    <span class="c1"># Turn off LED and move servo to close door</span>
    <span class="n">ledPin</span><span class="o">.</span><span class="n">off</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">180</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">setAngle</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>             <span class="c1"># Move servo from 180 to 0 degrees</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.001</span><span class="p">)</span>       <span class="c1"># Short delay for smooth movement</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>               <span class="c1"># Wait after closing door</span>

<span class="k">def</span> <span class="nf">opendoor</span><span class="p">():</span>
    <span class="c1"># Turn on LED, open door (move servo), play tune, close door</span>
    <span class="n">ledPin</span><span class="o">.</span><span class="n">on</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">181</span><span class="p">):</span>
        <span class="n">setAngle</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>             <span class="c1"># Move servo from 0 to 180 degrees</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.001</span><span class="p">)</span>       <span class="c1"># Short delay for smooth movement</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>               <span class="c1"># Wait before playing the tune</span>
    <span class="n">doorbell</span><span class="p">()</span>                  <span class="c1"># Play the doorbell tune</span>
    <span class="n">closedoor</span><span class="p">()</span>                 <span class="c1"># Close the door after the tune</span>

<span class="k">def</span> <span class="nf">loop</span><span class="p">():</span>
    <span class="c1"># Main loop to check for motion and operate door</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">pirPin</span><span class="o">.</span><span class="n">motion_detected</span><span class="p">:</span>
            <span class="n">opendoor</span><span class="p">()</span>               <span class="c1"># Open door if motion detected</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>              <span class="c1"># Short delay in loop</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">loop</span><span class="p">()</span>
<span class="k">except</span> <span class="ne">KeyboardInterrupt</span><span class="p">:</span>
    <span class="c1"># Clean up GPIO on user interrupt (e.g., Ctrl+C)</span>
    <span class="n">buzPin</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
    <span class="n">ledPin</span><span class="o">.</span><span class="n">off</span><span class="p">()</span>
</pre></div>
</div>
<p><strong>Code Explanation</strong></p>
<ol class="arabic">
<li><p>The script begins by importing necessary modules. The <code class="docutils literal notranslate"><span class="pre">gpiozero</span></code> library is used to interface with the LED, motion sensor, servo motor, and tonal buzzer. The <code class="docutils literal notranslate"><span class="pre">time</span></code> module is for handling timing-related functions.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env python3</span>
<span class="kn">from</span> <span class="nn">gpiozero</span> <span class="kn">import</span> <span class="n">LED</span><span class="p">,</span> <span class="n">MotionSensor</span><span class="p">,</span> <span class="n">Servo</span><span class="p">,</span> <span class="n">TonalBuzzer</span>
<span class="kn">import</span> <span class="nn">time</span>
</pre></div>
</div>
</li>
<li><p>Initializes the LED, PIR motion sensor, and tonal buzzer on their respective GPIO pins.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># GPIO pin setup for LED, motion sensor (PIR), and buzzer</span>
<span class="n">ledPin</span> <span class="o">=</span> <span class="n">LED</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="n">pirPin</span> <span class="o">=</span> <span class="n">MotionSensor</span><span class="p">(</span><span class="mi">21</span><span class="p">)</span>
<span class="n">buzPin</span> <span class="o">=</span> <span class="n">TonalBuzzer</span><span class="p">(</span><span class="mi">27</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Calculates the maximum and minimum pulse widths for the servo motor, incorporating a correction factor for fine-tuning.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Servo motor pulse width correction factor and calculation</span>
<span class="n">myCorrection</span> <span class="o">=</span> <span class="mf">0.45</span>
<span class="n">maxPW</span> <span class="o">=</span> <span class="p">(</span><span class="mf">2.0</span> <span class="o">+</span> <span class="n">myCorrection</span><span class="p">)</span> <span class="o">/</span> <span class="mi">1000</span>  <span class="c1"># Maximum pulse width</span>
<span class="n">minPW</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">myCorrection</span><span class="p">)</span> <span class="o">/</span> <span class="mi">1000</span>  <span class="c1"># Minimum pulse width</span>
</pre></div>
</div>
</li>
<li><p>Initializes the servo motor on GPIO pin 25 with the custom pulse widths for accurate positioning.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Initialize servo with custom pulse widths</span>
<span class="n">servoPin</span> <span class="o">=</span> <span class="n">Servo</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="n">min_pulse_width</span><span class="o">=</span><span class="n">minPW</span><span class="p">,</span> <span class="n">max_pulse_width</span><span class="o">=</span><span class="n">maxPW</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>The tune is defined as a sequence of notes (frequency) and durations (seconds).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Musical tune for buzzer, with notes and durations</span>
<span class="n">tune</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;C#4&#39;</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;D4&#39;</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">),</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;Eb4&#39;</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;E4&#39;</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">),</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;F#4&#39;</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;G4&#39;</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">),</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;Eb4&#39;</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;E4&#39;</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">),</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;F#4&#39;</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;G4&#39;</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">),</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;C4&#39;</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;B4&#39;</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">),</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;F#4&#39;</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;G4&#39;</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">),</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;B4&#39;</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;Bb4&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;A4&#39;</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;G4&#39;</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;E4&#39;</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;D4&#39;</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;E4&#39;</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">)]</span>
</pre></div>
</div>
</li>
<li><p>Function to move the servo to a specified angle. Converts the angle to a value between 0 and 1 for the servo.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">setAngle</span><span class="p">(</span><span class="n">angle</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Move the servo to a specified angle.</span>
<span class="sd">    :param angle: Angle in degrees (0-180).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">angle</span> <span class="o">/</span> <span class="mi">180</span><span class="p">)</span>  <span class="c1"># Convert angle to servo value</span>
    <span class="n">servoPin</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>      <span class="c1"># Set servo position</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.001</span><span class="p">)</span>           <span class="c1"># Short delay for servo movement</span>
</pre></div>
</div>
</li>
<li><p>Function to play a musical tune using the buzzer. Iterates through the <code class="docutils literal notranslate"><span class="pre">tune</span></code> list, playing each note for its specified duration.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">doorbell</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Play a musical tune using the buzzer.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">note</span><span class="p">,</span> <span class="n">duration</span> <span class="ow">in</span> <span class="n">tune</span><span class="p">:</span>
        <span class="n">buzPin</span><span class="o">.</span><span class="n">play</span><span class="p">(</span><span class="n">note</span><span class="p">)</span>       <span class="c1"># Play the note</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">duration</span><span class="p">))</span>  <span class="c1"># Duration of the note</span>
    <span class="n">buzPin</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>               <span class="c1"># Stop buzzer after playing the tune</span>
</pre></div>
</div>
</li>
<li><p>Functions to open and close the door using the servo motor. The <code class="docutils literal notranslate"><span class="pre">opendoor</span></code> function turns on the LED, opens the door, plays the tune, and then closes the door.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">closedoor</span><span class="p">():</span>
    <span class="c1"># Turn off LED and move servo to close door</span>
    <span class="n">ledPin</span><span class="o">.</span><span class="n">off</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">180</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">setAngle</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>             <span class="c1"># Move servo from 180 to 0 degrees</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.001</span><span class="p">)</span>       <span class="c1"># Short delay for smooth movement</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>               <span class="c1"># Wait after closing door</span>

<span class="k">def</span> <span class="nf">opendoor</span><span class="p">():</span>
    <span class="c1"># Turn on LED, open door (move servo), play tune, close door</span>
    <span class="n">ledPin</span><span class="o">.</span><span class="n">on</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">181</span><span class="p">):</span>
        <span class="n">setAngle</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>             <span class="c1"># Move servo from 0 to 180 degrees</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.001</span><span class="p">)</span>       <span class="c1"># Short delay for smooth movement</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>               <span class="c1"># Wait before playing the tune</span>
    <span class="n">doorbell</span><span class="p">()</span>                  <span class="c1"># Play the doorbell tune</span>
    <span class="n">closedoor</span><span class="p">()</span>                 <span class="c1"># Close the door after the tune</span>
</pre></div>
</div>
</li>
<li><p>Main loop that constantly checks for motion detection. When motion is detected, it triggers the <code class="docutils literal notranslate"><span class="pre">opendoor</span></code> function.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">loop</span><span class="p">():</span>
    <span class="c1"># Main loop to check for motion and operate door</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">pirPin</span><span class="o">.</span><span class="n">motion_detected</span><span class="p">:</span>
            <span class="n">opendoor</span><span class="p">()</span>               <span class="c1"># Open door if motion detected</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>              <span class="c1"># Short delay in loop</span>
</pre></div>
</div>
</li>
<li><p>Executes the main loop and ensures that the script can be stopped with a keyboard command (Ctrl+C), turning off the buzzer and LED for a clean exit.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">loop</span><span class="p">()</span>
<span class="k">except</span> <span class="ne">KeyboardInterrupt</span><span class="p">:</span>
    <span class="c1"># Clean up GPIO on user interrupt (e.g., Ctrl+C)</span>
    <span class="n">buzPin</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
    <span class="n">ledPin</span><span class="o">.</span><span class="n">off</span><span class="p">()</span>
</pre></div>
</div>
</li>
</ol>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="pi5_3.1.1_counting_device_python.html" class="btn btn-neutral float-left" title="3.1.1 Counting Device" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="pi5_3.1.3_reversing_alarm_python.html" class="btn btn-neutral float-right" title="3.1.3 Reversing Alarm" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, SunFounder.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>